<div id="page-tareas" class="page">
  <main class="panel panel-central">
    <div class="panel-header">
      <h2 id="titulo-tareas-pendientes" class="titulo-panel accent">
        Tareas Pendientes
      </h2>
      <div class="filtros-container">
        <button id="btn-filtros-dropdown" class="btn-filtro-dropdown">
          <span id="btn-filtros-label">Ordenar: Fecha</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 20 20"
            fill="currentColor"
            width="16"
            height="16"
          >
            <path
              fill-rule="evenodd"
              d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"
              clip-rule="evenodd"
            />
          </svg>
        </button>

        <div id="menu-filtros-dropdown" class="filtro-dropdown-menu"></div>
      </div>
    </div>
    <div
      id="tareas-header-contextual"
      class="panel-header contextual"
      style="display: none"
    >
      <span id="seleccion-contador">0 seleccionada(s)</span>
      <div class="actions-group">
        <div
          class="custom-checkbox-container"
          title="Seleccionar Todas/Ninguna"
        >
          <input
            type="checkbox"
            id="seleccionar-todas-tareas"
            data-action="seleccionar-todas"
          />
          <label for="seleccionar-todas-tareas"></label>
        </div>

        <button
          id="btn-completar-seleccionadas"
          class="btn-icon"
          title="Marcar como Completadas"
          data-action="completar-seleccion"
        ></button>

        <button
          id="btn-eliminar-seleccionadas"
          class="btn-icon btn-eliminar-item"
          title="Eliminar Seleccionadas"
          data-action="eliminar-seleccion"
        ></button>

        <button
          id="btn-cancelar-seleccion"
          class="btn-icon"
          title="Cancelar Selección"
          data-action="cancelar-seleccion"
        ></button>
      </div>
    </div>
    <div class="tabla-container">
      <table class="tabla-tareas tabla-tareas-visible">
        <thead>
          <tr>
            <th></th>
            <th data-sort="curso">Curso</th>
            <th data-sort="prioridad" class="col-prioridad">Prioridad</th>
            <th data-sort="titulo">Título</th>
            <th data-sort="fecha">Entrega</th>
            <th class="col-acciones"></th>
          </tr>
        </thead>
        <tbody id="tabla-tareas-body"></tbody>
      </table>
    </div>
  </main>
  <section id="panel-creacion" class="panel">
    <form id="form-nueva-tarea" class="form-panel-tarea">
      <h2 class="titulo-panel accent">Agregar Nueva Tarea</h2>

      <div class="form-row">
        <div class="form-group" style="flex: 1 1 50%">
          <label for="select-curso-tarea">Curso:</label>
          <select id="select-curso-tarea"></select>
        </div>
        <div class="form-group" style="flex: 1 1 50%">
          <label for="select-proyecto-tarea">Proyecto (Opcional):</label>
          <select id="select-proyecto-tarea"></select>
        </div>
      </div>

      <div class="form-group">
        <label for="input-titulo-tarea">Título:</label>
        <input
          type="text"
          id="input-titulo-tarea"
          placeholder="¿Qué necesitas hacer?"
          required
        />
      </div>

      <div class="form-group">
        <label for="input-desc-tarea">Descripción:</label>
        <textarea
          id="input-desc-tarea"
          placeholder="Añade más detalles..."
          rows="4"
        ></textarea>
      </div>

      <div class="form-row">
        <div
          class="form-group"
          style="flex: 1 1 calc(50% - 8px); min-width: 150px"
        >
          <label for="input-fecha-tarea">Fecha:</label>
          <input type="date" id="input-fecha-tarea" required />
        </div>
        <div
          class="form-group"
          style="flex: 1 1 calc(50% - 8px); min-width: 150px"
        >
          <label for="select-prioridad-tarea">Prioridad:</label>
          <select id="select-prioridad-tarea">
            <option value="Baja">Baja</option>
            <option value="Media" selected>Media</option>
            <option value="Alta">Alta</option>
          </select>
        </div>
      </div>

      <button type="submit" id="btn-guardar-tarea" class="btn-accent">
        Guardar Tarea
      </button>
    </form>
  </section>
  <section
    id="panel-detalles"
    class="panel panel-derecho panel-detalles-optimizado"
  >
    <div class="detalle-header-fijo">
      <div class="detalle-titulo-acciones">
        <h3 id="det-titulo">Selecciona una tarea</h3>
        <div class="detalle-acciones-principales">
          <button id="btn-completar-tarea" class="btn-full-width" disabled>
            Marcar como Completada
          </button>
          <button
            id="btn-editar-tarea"
            class="btn-icon"
            title="Editar Tarea"
            disabled
          ></button>

          <button
            id="btn-enviar-a-grupo"
            class="btn-icon"
            title="Enviar a Grupo"
            disabled
          ></button>
          <button
            id="btn-eliminar-tarea"
            class="btn-icon btn-eliminar-item"
            title="Eliminar Tarea"
            disabled
          ></button>
        </div>
      </div>
      <button
        id="btn-cerrar-detalles"
        class="btn-icon btn-cerrar-panel"
      ></button>
      <hr class="detalle-divisor" />
    </div>

    <div id="detalles-contenido-scrollable">
      <div id="det-proyecto-container" style="display: none">
        <h4>Proyecto:</h4>
        <p id="det-proyecto-nombre"></p>
      </div>

      <h4>Descripción:</h4>
      <p id="det-descripcion" class="detalle-descripcion-box"></p>

      <div class="subtareas-container" style="display: none">
        <h4>Sub-tareas</h4>
        <ul id="lista-subtareas"></ul>
        <div class="form-agregar-subtarea">
          <input
            type="text"
            id="input-nueva-subtarea"
            placeholder="Nueva sub-tarea..."
          />
          <button id="btn-agregar-subtarea" class="btn-accent">+</button>
        </div>
      </div>
    </div>
  </section>
  <button id="btn-abrir-creacion-movil" class="btn-flotante-agregar"></button>
</div>

<div id="modal-enviar-a-grupo" class="modal-overlay" style="display: none">
  <div class="modal-container modal-pequeno">
    <div class="modal-header">
      <h3>Enviar Tarea a Grupo</h3>
      <button
        class="btn-icon btn-cerrar-modal"
        data-action="cerrar-modal"
        aria-label="Cerrar modal"
      ></button>
    </div>
    <div class="modal-content">
      <p class="text-muted" style="margin-bottom: 16px">
        Esto creará una nueva tarea de grupo ("hilo") basada en esta tarea
        privada.
      </p>
      <form id="form-enviar-a-grupo" onsubmit="return false;">
        <div class="form-group">
          <label for="select-enviar-a-grupo">Selecciona un grupo:</label>
          <select id="select-enviar-a-grupo" required></select>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <button
        class="btn-secondary"
        data-action="cerrar-modal"
        id="btn-cancelar-enviar-a-grupo"
      >
        Cancelar
      </button>
      <button class="btn-accent" id="btn-confirmar-enviar-a-grupo">
        Enviar a Grupo
      </button>
    </div>
  </div>
</div>
